<html>

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="renderer" content="webkit"/>
    <title>幸福家采集系统 - 主页</title>
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->

    <link rel="shortcut icon" href="favicon.ico" />
    <link href="/css/bootstrap.min.css?v=3.3.6" rel="stylesheet"/>
    <link href="/css/font-awesome.min.css?v=4.4.0" rel="stylesheet"/>
    <link href="/css/animate.css" rel="stylesheet"/>
    <link href="/css/style.css?v=4.1.0" rel="stylesheet"/>
    <style type="text/css">
        table td{
            word-break: break-all;
            word-wrap:break-word;
        }

    </style>
</head>
<body class="fixed-sidebar full-height-layout gray-bg" style="overflow: auto" >
<div class="ibox-content">
    <div class="row">
        <div class="row">
            <div class="col-sm-5 form-group">
                <select class="form-control for-chosen" id="type" name="type">
                    <option value="">类型</option>
                    <option value="买房">买房</option>
                    <option value="卖房">卖房</option>
                    <option value="租房">租房</option>
                    <option value="家居">家居</option>
                    <option value="政策">政策</option>
                </select>
            </div>
            <div class="col-sm-5 form-group">
                <select class="form-control for-chosen" id="tag" name="tag">
                    <option value="">标签</option>
                    <option value="购房知识">购房知识</option>
                    <option value="趋势走向">趋势走向</option>
                    <option value="落户">落户</option>
                    <option value="产权">产权</option>
                    <option value="资金">资金</option>
                </select>
            </div>
            <div class="col-sm-5 form-group">
                <div class="input-group">
                    <input id="keyWord" type="text" class="form-control" name="keyWord" placeholder="标签/类型/问题">
                    <span class="input-group-btn">
                    <button type="button" class="btn btn-light btn-outline" onclick="submitPageForm();">搜索</button>
                </span>
                </div>
            </div>
        </div>

        <div class="ibox-content">
            <table id="table1" style="table-layout:fixed;" class="table table-striped table-bordered table-hover ">
                <thead>
                <tr>
                    <th style="width: 15%">问题</th>
                    <th style="width: 15%">回复</th>
                    <th style="width: 15%">类型</th>
                    <th style="width: 15%">发布时间</th>
                    <th style="width: 15%">状态</th>
                    <th style="width: 15%">操作</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- 全局js -->
<script src="/js/jquery.min.js?v=2.1.4"></script>
<script src="/js/bootstrap.min.js?v=3.3.6"></script>


<script src="/js/plugins/layer/layer.min.js"></script>
<!-- 自定义js -->
<script src="/js/content.js?v=1.0.0"></script>
<!--缩略图-->
<script src="/js/plugins/webuploader/webuploader.min.js"></script>
<!-- Steps -->
<script src="/js/plugins/staps/jquery.steps.min.js"></script>
<script src="/js/util/Area.js"></script>
<script src="/js/util/AreaData_min.js"></script>
<!-- Jquery Validate -->
<script src="/js/plugins/validate/jquery.validate.min.js"></script>
<script src="/js/plugins/validate/messages_zh.min.js"></script>
<script src="/js/tinyImgUpload.js"></script>
<script src="/js/plugins/layer/laydate/laydate.js"></script>
<!-- Data Tables -->
<script src="/js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="/js/plugins/dataTables/dataTables.bootstrap.js"></script>
<script>
    var table1 = $('#table1');
    $(function () {
        initTable();
    });

    function submitPageForm(){
        table1.fnClearTable();
    }
    function initTable(){

        table1.dataTable({
            processing: true,
            serverSide: true,
            searching: false,
            autoWidth: true,
            bDestory : true,
            language: {url: '/js/plugins/dataTables/language/Chinese.json'},
            ajax: {
                url:"/houseQuestion/getQuestionList",
                data: function (d) {
                    planify(d);
                    d.keyWord = $("#keyWord").val();
                    d.type = $("#type").val();
                    d.tag = $("#tag").val();
                },
                type: "get",
            },
            columnDefs: [
                {
                    "defaultContent": "",
                    "targets": "_all"
                }
            ],
            columns:[
                {"name":"hqContent","data":function (row) {
                        return row.hqContent;
                    }},
                {"name":"commentsContent","data":"commentsContent"},
                {"name":"hqType","data":"hqType"},
                {"name":"hqTag","data":"hqTag"},
                {"name":"hqPublishTime","data":"hq_publish_time"},
                {"name":"hsStatus","data":function (row) {
                        if(row.hsStatus == 0){
                            return "未看";
                        }else if(row.hsStatus == 1){
                            return "引用";
                        }else if(row.hsStatus == 2){
                            return "待用";
                        }else if(row.hsStatus == 3){
                            return "弃用";
                        }
                    }}

            ]
        })
    }

    //处理时间
    function getMyDate(str) {
        if(str != null && str != undefined) {
            var oDate = new Date(str),
                oYear = oDate.getFullYear(),
                oMonth = oDate.getMonth() + 1,
                oDay = oDate.getDate(),
                oHour = oDate.getHours(),
                oMin = oDate.getMinutes(),
                oSen = oDate.getSeconds(),
                oTime = oYear + '-' + getzf(oMonth) + '-' + getzf(oDay) + ' ' + getzf(oHour) + ':' + getzf(oMin) + ':' + getzf(oSen);
            return oTime;
        }else {
            return "无";
        }
    }
    //月份补零
    function getzf(num){
        if(parseInt(num) < 10){
            num = '0'+num;
        }
        return num;
    }
    /**
     * 转换datatables的参数设置
     * @param data
     */
    function planify(data) {
        for (var i = 0; i < data.columns.length; i++) {
            column = data.columns[i];
            column.searchRegex = column.search.regex;
            column.searchValue = column.search.value;
            delete (column.search);
        }
    }


</script>
</body>

</html>